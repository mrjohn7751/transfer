<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.1/css/bootstrap.min.css"
      integrity="sha512-Z/def5z5u2aR89OuzYcxmDJ0Bnd5V1cKqBEbvLOiUNWdg9PQeXVvXLI90SE4QOHGlfLqUnDNVAYyZi8UwUTmWQ=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css"
      integrity="sha512-z3gLpd7yknf1YoNbCzqRKc4qyor8gaKU1qmn+CShxbuBusANI9QpRohGBreCFkKxLhei6S9CQXFEbbKuqLg0DA=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
    <title>Document</title>
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#myModal">
        Qoshish
    </button>

    <!-- Modal -->
    <div class="modal" id="myModal" tabindex="-1" aria-hidden="true">
      <div class="modal-dialog modal-lg">
        <div class="modal-content">
          <div class="modal-header">
            <h1 class="modal-title fs-5">Royhatdan O'tgazish</h1>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body">
            <form>
              <div class="row needs-validation" novalidate>
                <div
                  class="col col-12 col-sm-12 col-md-6 col-lg-6 col-xl-6 col-xxl-6"
                >
                  <div class="mb-3">
                    <label for="firstName" class="form-label">FISH</label>
                    <input
                      type="text"
                      class="form-control"
                      placeholder="Berdiyev Jahongir Abdurashidovich"
                      id="firstName"
                      aria-describedby="emailHelp"
                      name="firstName"
                      required
                    />
                  </div>
                </div>
                <div
                  class="col col-12 col-sm-12 col-md-6 col-lg-6 col-xl-6 col-xxl-6"
                >
                  <div class="mb-3">
                    <label for="lastName" class="form-label"
                      >Nimaga Nomzodligi</label
                    >
                    <input
                      type="text"
                      class="form-control"
                      placeholder="Nimaga Nomzodligi"
                      id="lastName"
                      aria-describedby="emailHelp"
                      name="lastName"
                      required
                    />
                  </div>
                </div>
                <div
                  class="col col-12 col-sm-12 col-md-6 col-lg-6 col-xl-6 col-xxl-6"
                >
                  <div class="mb-3">
                    <label for="image">Select PNG or JPG file:</label>

                    <input
                      type="file"
                      id="image"
                      accept=".png, .jpg, .jpeg"
                      name="image"
                      required
                    />
                    <div class="valid-feedback">Looks good!</div>
                  </div>
                </div>
              </div>
            </form>
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-secondary"
              data-bs-dismiss="modal"
            >
              Close
            </button>
            <button
              type="button"
              class="btn btn-primary"
              id="saveButton"
              onclick="saveData()"
            >
              Save changes
            </button>
          </div>
        </div>
      </div>
    </div>
    <table class="table table-bordered" id="dataTable">
      <thead>
        <tr>
          <th data-label="order" style="width: 50px;">â„–</th>
          <th data-label="fish">Fish</th>
          <th data-label="caption">Nimaga davogarligi</th>
          <th data-label="action">Actions</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>

    <script src="./script.js"></script>

    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.1/js/bootstrap.min.js"
      integrity="sha512-fHY2UiQlipUq0dEabSM4s+phmn+bcxSYzXP4vAXItBvBHU7zAM/mkhCZjtBEIJexhOMzZbgFlPLuErlJF2b+0g=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    ></script>
    <script>document.addEventListener("DOMContentLoaded", function () {
        // Open modal function
        function openModal() {
          var modal = document.getElementById("myModal");
          modal.style.display = "block";
        }
      
        // Save data function
        function saveData() {
          // Get form field values
          var firstName = document.getElementById("firstName").value;
          var lastName = document.getElementById("lastName").value;
      
          // Create new row in table
          var table = document.getElementById("dataTable");
          var row = table.insertRow(-1);
      
          // Add data to row cells
          var orderCell = row.insertCell(0);
          var firstNameCell = row.insertCell(1);
          var lastNameCell = row.insertCell(2);
          var deleteCell = row.insertCell(3);
      
          orderCell.innerHTML = table.rows.length - 1; // Order cell is the current number of rows in the table minus the header row
          firstNameCell.innerHTML = firstName;
          lastNameCell.innerHTML = lastName;
      
          // Add delete button to delete cell
          var deleteButton = document.createElement("button");
          deleteButton.innerHTML = "Delete";
          deleteButton.className = "btn btn-outline-danger";
      
          deleteButton.onclick = function () {
            table.deleteRow(row.rowIndex);
            // Reorder the table rows
            for (var i = 1; i < table.rows.length; i++) {
              table.rows[i].cells[0].innerHTML = i;
            }
            // Update local storage with new data
            updateLocalStorage();
          };
      
          deleteCell.appendChild(deleteButton);
      
          // Close modal and reset form fields
          var modal = document.getElementById("myModal");
          modal.style.display = "none";
      
          document.getElementById("firstName").value = "";
          document.getElementById("lastName").value = "";
      
          // Save data to local storage
          saveToLocalStorage();
        }
      
        // Save data to local storage function
        function saveToLocalStorage() {
          var tableData = [];
      
          var rows = document.querySelectorAll("#dataTable tbody tr");
      
          rows.forEach(function (row) {
            var rowData = {
              order: row.cells[0].innerHTML,
              firstName: row.cells[1].innerHTML,
              lastName: row.cells[2].innerHTML,
            };
            tableData.push(rowData);
          });
      
          localStorage.setItem("tableData", JSON.stringify(tableData));
        }
      
        // Load data from local storage function
        function loadFromLocalStorage() {
          var tableData = JSON.parse(localStorage.getItem("tableData"));
      
          if (tableData) {
            var table = document.getElementById("dataTable");
      
            tableData.forEach(function (rowData) {
              var row = table.insertRow(-1);
      
              var orderCell = row.insertCell(0);
              var firstNameCell = row.insertCell(1);
              var lastNameCell = row.insertCell(2);
              var deleteCell = row.insertCell(3);
      
              orderCell.innerHTML = rowData.order;
              firstNameCell.innerHTML = rowData.firstName;
              lastNameCell.innerHTML = rowData.lastName;
      
              var deleteButton = document.createElement("button");
              deleteButton.innerHTML = "Delete";
              deleteButton.className = "btn btn-outline-danger";
      
              deleteButton.onclick = function () {
                table.deleteRow(row.rowIndex);
                // Reorder the table rows
                for (var i = 1; i < table.rows.length; i++) {
                  table.rows[i].cells[0].innerHTML = i;
                }
                // Update local storage with new data
                updateLocalStorage();
              };
      
              deleteCell.appendChild(deleteButton);
            });
          }
        }
      
        // Update local storage with new data function
        function updateLocalStorage() {
          localStorage.clear();
          saveToLocalStorage();
        }
      
        // Load data from local storage on page load
        loadFromLocalStorage();
      });
      </script>
  </body>
</html>